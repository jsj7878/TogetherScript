# 7.1 API í˜¸ì¶œí•˜ê¸°

1. fetch ë¡œ api í˜¸ì¶œí•˜ê¸°

   - ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ì—ì„œ fetch ë¥¼ í†µí•´ API ë¥¼ í˜¸ì¶œí•œ ëª¨ìŠµ

   ```tsx
   import React, { useEffect, useState } from "react";

   const CartBadge: React.FC = () => {
     const [cartCount, setCartCount] = useState(0);

     useEffect(() => {
       fetch("https://api.baemin.com/cart")
         .then((response) => response.json())
         .then(({ cartItem }) => {
           setCartCount(cartItem.length);
         });
     }, []);

     return <>{/* cartCount ìƒíƒœë¥¼ ì´ìš©í•˜ì—¬ ì»´í¬ë„ŒíŠ¸ ë Œë”ë§ */}</>;
   };
   ```

   - ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ì—ì„œ í˜¸ì¶œí–ˆê¸° ë•Œë¬¸ì— ë°±ì—”ë“œì—ì„œ ë³€ê²½ì´ ìˆì„ ì‹œ ë§ì€ ê²ƒì„ ë°”ê¾¸ì–´ì•¼ í•˜ëŠ” ë²ˆê±°ë¡œì›€ì´ ìˆì„ ìˆ˜ ìˆìŒ.

1. ì„œë¹„ìŠ¤ ë ˆì´ì–´ë¡œ ë¶„ë¦¬í•˜ê¸°

   - ë¹„ë™ê¸° í˜¸ì¶œ ì½”ë“œëŠ” ì»´í¬ë„ŒíŠ¸ ì˜ì—­ì—ì„œ ë¶„ë¦¬ë˜ì–´ ë‹¤ë¥¸ ì˜ì—­(ì„œë¹„ìŠ¤ ë ˆì´ì–´) ì—ì„œ ì²˜ë¦¬ë˜ì–´ì•¼ í•œë‹¤.
   - ìœ„ì˜ ì½”ë“œì—ì„œ fetch í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ëŠ” ë¶€ë¶„ì´ ì„œë¹„ìŠ¤ ë ˆì´ì–´ë¡œ ì´ë™í•˜ê³  ì»´í¬ë„ŒíŠ¸ëŠ” ì„œë¹„ìŠ¤ ë ˆì´ì–´ì˜ ë¹„ë™ê¸° í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ì—¬ ê·¸ ê²°ê³¼ë¥¼ ë°›ì•„ì™€ ë Œë”ë§í•˜ëŠ” íë¦„ì´ ëœë‹¤.

1. Axios í™œìš©í•˜ê¸°

   - fetch ëŒ€ì‹  axios ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥´ ì‚¬ìš©.
   - ë§Œì•½ ê¸°ì¡´ ì‚¬ìš©í•˜ë˜ base url ê³¼ ë‹¤ë¥¸ ìƒˆë¡œìš´ url ì„ ìš”ì²­í•´ì•¼ í•œë‹¤ë©´ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë”°ë¡œ êµ¬ì„±í•´ì•¼ í•œë‹¤.

1. axios ì¸í„°ì…‰í„° ì‚¬ìš©í•˜ê¸°

   - request ë³„ë¡œ ë‹¤ë¥¸ í—¤ë”ë¥¼ ì„¤ì •í•´ì¤˜ì•¼ í•˜ëŠ” ë¡œì§ì´ í•„ìš”í•  ìˆ˜ë„ ìˆëŠ”ë° ì´ë¥¼ ì¸í„°ì…‰í„° ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ì—¬ ê° requester ì— ë”°ë¼ ë¹„ë™ê¸° í˜¸ì¶œ ë‚´ìš©ì„ ì¶”ê°€í•´ì„œ ì²˜ë¦¬í•œë‹¤.
   - ë˜ëŠ” ìš”ì²­ ì˜µì…˜ì— ë”°ë¼ ë‹¤ë¥¸ ì¸í„°ì…‰í„°ë¥¼ ë§Œë“¤ê¸° ìœ„í•´ ë¹Œë” íŒ¨í„´ì„ ì¶”ê°€í•˜ì—¬ API Builder í´ë˜ìŠ¤ í˜•íƒœë¥¼ êµ¬ì„±í•˜ê¸°ë„ í•œë‹¤.
   - ì½”ë“œëŠ” ì§ì ‘ ì±…ì„ ë³´ì. ë„ˆë¬´ ê¸¸ë‹¤. (p205 ~ p207)
   - ë³´ì¼ëŸ¬ í”Œë ˆì´íŠ¸ ì½”ë“œê°€ ê¸¸ë‹¤ëŠ” ë‹¨ì ì„ ê°€ì§€ê³  ìˆì§€ë§Œ, í•„ìš”í•œ ê¸°ëŠ¥ì„ ì„ íƒí•´ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ”ê²ƒ ê°™ì•„ ë§¤ë ¥ì ìœ¼ë¡œ ë³´ì¸ë‹¤.

1. API ì‘ë‹µ íƒ€ì… ì§€ì •í•˜ê¸°

   - ê°™ì€ ì„œë²„ì—ì„œ ì˜¤ëŠ” ì‘ë‹µì˜ í˜•íƒœëŠ” ëŒ€ì²´ë¡œ í†µì¼ë˜ì–´ ìˆì–´ì„œ, API ì‘ë‹µ ê°’ì„ í•˜ë‚˜ì˜ Response íƒ€ì…ìœ¼ë¡œ ë¬¶ì¼ ìˆ˜ ìˆë‹¤.
   - Response íƒ€ì…ì„ apiRequester ë‚´ì—ì„œ ì²˜ë¦¬í•˜ê³  ì‹¶ì€ ìƒê°ì´ ë“¤ ìˆ˜ ìˆëŠ”ë° ê·¸ë ‡ê²Œ ë˜ë©´, UPDATE ë‚˜ CREATE ê°™ì€ ì‘ë‹µì´ ì—†ì„ ìˆ˜ ìˆëŠ” API ë¥¼ ì²˜ë¦¬í•˜ê¸° ê¹Œë‹¤ë¡œì›Œ ì§„ë‹¤.

   ```tsx
   interface Response<T> {
     data: T;
     status: string;
     serverDateTime: string;
     errorCode?: string; // FAIL, ERROR
     errorMessage?: string; // FAIL, ERROR
   }

   const fetchCart = (): AxiosPromise<Response<FetchCartResponse>> =>
     apiRequester.get<Response<FetchCartResponse>>("cart");

   const postCart = (
     postCartRequest: PostCartRequest
   ): AxiosPromise<Response<PostCartResponse>> =>
     apiRequester.post<Response<PostCartResponse>>("cart", postCartRequest);

   const updateCart = (
     updateCartRequest
   ): AxiosPromise<Response<FetchCartResponse>> => apiRequester.get("cart");
   ```

   - **API ì‘ë‹µ êµ¬ì¡°ë¥¼ í†µí•©ëœ ì œë„¤ë¦­ íƒ€ì…(`Response<T>`)ìœ¼ë¡œ ê´€ë¦¬**í•˜ê³ , ì´ë¥¼ í†µí•´ API ìš”ì²­/ì‘ë‹µì„ ìœ ì—°í•˜ê²Œ ì²˜ë¦¬í•œë‹¤ëŠ” ê²ƒìœ¼ë¡œ ë³´ì„. ì´ë¥¼ í†µí•´:
     1. ì‘ë‹µ ë°ì´í„°ì˜ íƒ€ì…ì„ `apiRequester`ì— ì¢…ì†ë˜ì§€ ì•Šê²Œ ì„¤ê³„í•œë‹¤.
     2. ì œë„¤ë¦­ì„ í™œìš©í•´ ê° APIì˜ ì‘ë‹µ êµ¬ì¡°ë¥¼ ëª…í™•íˆ ê´€ë¦¬í•œë‹¤.
   - íŠ¹ì • API ì„œë²„ë¡œë¶€í„° ë°ì´í„°ë¥¼ ë°›ì„ ë•Œ, ì¼ë¶€ ë°ì´í„°(`forPass`)ì˜ êµ¬ì¡°ë‚˜ íƒ€ì…ì„ ì•Œ ìˆ˜ ì—†ëŠ” ê²½ìš°ê°€ ìˆë‹¤. ì´ëŸ¬í•œ ë°ì´í„°ëŠ” **í”„ë¡ íŠ¸ì—”ë“œ ë¡œì§ì—ì„œ ì‚¬ìš©ë˜ì§€ ì•Šë”ë¼ë„**, ë¡œê·¸ë¥¼ ë‚¨ê¸°ê±°ë‚˜ ë‹¤ë¥¸ ì„œë²„ë¡œ ì „ë‹¬í•´ì•¼ í•˜ëŠ” ê²½ìš°ê°€ ìˆëŠ”ë° ì´ëŸ´ ë•Œ unknown íƒ€ì…ì„ ì‚¬ìš©í•˜ì—¬ ì•Œ ìˆ˜ ì—†ëŠ” ê°’ì„ì„ í‘œí˜„í•œë‹¤.

   ```tsx
   interface Response {
     data: {
       cartItems: CartItem[]; // ì¥ë°”êµ¬ë‹ˆ í•­ëª©ì€ ëª…í™•íˆ íƒ€ì… ì§€ì •
       forPass: unknown; // êµ¬ì¡°ë‚˜ ë‚´ìš©ì´ ì•Œ ìˆ˜ ì—†ëŠ” ê°’
     };
   }
   ```

   - ë‹¤ë§Œ ì´ë¯¸ ì„¤ê³„ëœ í”„ë¡œë•íŠ¸ì—ì„œ ì“°ê³  ìˆëŠ” ê°’ì´ë¼ë©´ ì¨ì•¼ í•˜ëŠ” ê°’ì— ëŒ€í•´ì„œë§Œ íƒ€ì…ì„ ì„ ì–¸í•˜ê³  ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¡¶ë‹¤.

1. ë·° ëª¨ë¸ (view model) ì‚¬ìš©í•˜ê¸°

   - API ì‘ë‹µì€ ë³€í•  ê°€ëŠ¥ì„±ì´ í¬ë‹¤. íŠ¹íˆ ìƒˆë¡œìš´ í”„ë¡œì íŠ¸ëŠ” ì„œë²„ ìŠ¤í™ì´ ìì£¼ ë°”ë€Œê¸° ë•Œë¬¸ì— ë·° ëª¨ë¸ì„ ì‚¬ìš©í•˜ì—¬ API ë³€ê²½ì— ë”°ë¥¸ ë²”ìœ„ë¥¼ í•œì •í•´ì¤˜ì•¼ í•œë‹¤.

   [ë·° ëª¨ë¸ì´ë€? (feat MVVM íŒ¨í„´)](https://www.notion.so/feat-MVVM-164f2528fe7880ecbbb9f06994f25acd?pvs=21)

   - í”íˆ ì¢‹ì€ ì»´í¬ë„ŒíŠ¸ë€ ë³€ê²½ë  ì´ìœ ê°€ í•˜ë‚˜ë¿ì¸ ì»´í¬ë„ŒíŠ¸ë¼ê³  ë§í•œë‹¤. ìˆ˜ì •í•´ì•¼ í•  ì»´í¬ë„ŒíŠ¸ê°€ API ë‹¹ 1ê°œë¼ë©´ ì¢‹ê² ì§€ë§Œ, API ë¥¼ ì‚¬ìš©í•˜ëŠ” ê¸°ì¡´ ì»´í¬ë„ŒíŠ¸ë„ ìˆ˜ì •ë˜ì–´ì•¼ í•œë‹¤.
   - í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í•œ ë·° ëª¨ë¸ êµ¬í˜„

   ```tsx
   // ê¸°ì¡´ ListResponseì— ë” ìì„¸í•œ ì˜ë¯¸ë¥¼ ë‹´ê¸° ìœ„í•œ ë³€í™”
   interface JobListItemResponse {
     name: string;
   }

   interface JobListResponse {
     jobItems: JobListItemResponse[];
   }

   class JobList {
     readonly totalItemCount: number;
     readonly items: JobListItemResponse[];

     constructor({ jobItems }: JobListResponse) {
       this.totalItemCount = jobItems.length;
       this.items = jobItems;
     }
   }

   const fetchJobList = async (filter?: ListFetchFilter): Promise<JobList> => {
     const { data } = await api
       .params({ ...filter })
       .get("/apis/get-list-summaries")
       .call<Response<JobListResponse>>();

     return new JobList(data);
   };
   ```

   - ë·° ëª¨ë¸ì„ ë§Œë“¤ì–´ API ì‘ë‹µì´ ê¹¨ì§€ì§€ ì•Šë„ë¡ ê°œë°œí•  ìˆ˜ ìˆë‹¤.? API ì‘ë‹µì— ì—†ëŠ” totalItemCount ì™€ ê°™ì€ ë„ë©”ì¸ ê°œë…ì„ ë„£ì„ ë•Œ ë°±ì—”ë“œë‚˜ UI ì—ì„œ ë¡œì§ì„ ì¶”ê°€í•˜ì—¬ ì²˜ë¦¬í•  í•„ìš”ì—†ì´ ê°„ë‹¨í•˜ê²Œ ìƒˆë¡œìš´ í•„ë“œë¥¼ ë·° ëª¨ë¸ì— ì¶”ê°€í•˜ë„ë¡ êµ¬í˜„.
   - ë‹¤ë§Œ ë·° ëª¨ë¸ì—ë„ ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆìŒ. ì¶”ìƒí™” ë ˆì´ì–´ì˜ ì¶”ê°€ëŠ” ê²°êµ­ ì½”ë“œì˜ ë³µì¡ë„ë¥¼ ë†’ì´ê³  ê°œë°œ ë¹„ìš©ì„ ì¦ê°€ì‹œí‚¨ë‹¤. ì•ì˜ ì½”ë“œì—ì„œ JobListItemResponse íƒ€ì…ì€ ì„œë²„ì—ì„œ ì§€ì •í•œ íƒ€ì…ì´ë¯€ë¡œ UI ì—ì„œ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œëŠ” ì•„ë˜ì™€ ê°™ì´ ë” ë§ì€ íƒ€ì…ì„ ì„ ì–¸í•´ì•¼ í•¨.

   ```tsx
   interface JobListResponse {
     jobItems: JobListItemResponse[];
   }

   class JobListItem {
     constructor(item: JobListItemResponse) {
       /* JobListItemResponseì—ì„œ JobListItem ê°ì²´ë¡œ ë³€í™˜í•´ì£¼ëŠ” ì½”ë“œ */
       // ì¶”ê°€ë¨.
     }
   }

   class JobList {
     readonly totalItemCount: number;
     readonly items: JobListItem[];

     constructor({ jobItems }: JobListResponse) {
       this.totalItemCount = jobItems.length;
       this.items = jobItems.map((item) => new JobListItem(item));
     }
   }

   const fetchJobList = async (filter?: ListFetchFilter): Promise<JobList> => {
     const { data } = await api
       .params({ ...filter })
       .get("/apis/get-list-summaries")
       .call<Response<JobListResponse>>();

     return new JobList(data);
   };
   ```

   - ë‹¨ìˆœí•˜ê²Œ API 20ê°œë¥¼ ì¶”ê°€í•œë‹¤ë©´ 20ê°œì˜ ì‘ë‹µì´ ì¶”ê°€ë  ê²ƒì´ë‹¤. ì¦‰ 20ê°œ ì´ìƒì˜ ë·° ëª¨ë¸ì´ ì¶”ê°€ë  ìˆ˜ ìˆë‹¤ëŠ” ëœ». ë˜í•œ totalItemCount ì™€ ê°™ì´ API ì‘ë‹µì—ëŠ” ì—†ëŠ” ìƒˆë¡œìš´ í•„ë“œë¥¼ ë§Œë“¤ì–´ ì‚¬ìš©í•  ë•Œ ì„œë²„ì™€ í´ë¼ì´ì–¸íŠ¸ ê°„ì˜ ì˜ì‚¬ì†Œí†µ ë¬¸ì œ ë˜í•œ ìƒê¸¸ ìˆ˜ ìˆë‹¤. â†’ ê²°êµ­ API ì‘ë‹µì´ ë°”ë€Œì—ˆì„ ë•Œ ë¹„ìš©ì„ ì¤„ì´ë©´ì„œ ë„ë©”ì¸ì˜ ì¼ê´€ì„±ì„ ì§€í‚¬ ìˆ˜ ìˆëŠ” ì ˆì¶©ì•ˆ í•„ìš”.
   - í•„ìš”í•œ ê³³ì—ì„œë§Œ ë·° ëª¨ë¸ì„ ë§Œë“¤ì–´ ì‚¬ìš©í•˜ê¸°, ë°±ì—”ë“œì™€ í´ë¼ì´ì–¸íŠ¸ ê°œë°œìê°€ ì¶©ë¶„í•œ ì†Œí†µì„ í•œ í›„ API ë³€í™” ì¤„ì´ê¸°, ë·° ëª¨ë¸ì— í•„ë“œë¥¼ ì¶”ê°€í•˜ëŠ” ëŒ€ì‹ ì— getter í•¨ìˆ˜ë“±ì„ í†µí•´ ì–´ë–¤ ê°’ì´ ì¶”ê°€í•œ ê°’ì¸ì§€ ì•Œê¸° ì‰½ê²Œ í•˜ê¸° ë“± ë°©ë²•ì´ ìˆë‹¤.

1. Superstuct ë¥¼ ì‚¬ìš©í•´ ëŸ°íƒ€ì„ì—ì„œ ì‘ë‹µ íƒ€ì… ê²€ì¦í•˜ê¸°

   > ê°œë°œ ë‹¨ê³„ì—ì„œëŠ” API ì‘ë‹µ í˜•ì‹ì´ ìì£¼ ë°”ë€ë‹¤. ë˜í•œ ì˜ëª»ëœ íƒ€ì…ì´ ì „ë‹¬ë˜ê¸°ë„ í•œë‹¤. ê·¸ëŸ¬ë‚˜ íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ëŠ” ì •ì  ê²€ì‚¬ ë„êµ¬ë¡œ ëŸ°íƒ€ì„ ì˜¤ë¥˜ëŠ” ì°¾ì•„ë‚¼ ìˆ˜ ì—†ë‹¤. ëŸ°íƒ€ì„ ì˜¤ë¥˜ë¥¼ ë°©ì§€í•˜ë ¤ë©´ Superstruct ì™€ ê°™ì€ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ë©´ ëœë‹¤.

   - Superstruct ë¼ì´ë¸ŒëŸ¬ë¦¬ ì†Œê°œ
     - ì¸í„°í˜ì´ìŠ¤ ì •ì˜ì™€ ìë°”ìŠ¤í¬ë¦½íŠ¸ ë°ì´í„° ìœ íš¨ì„± ê²€ì‚¬ë¥¼ ì‰½ê²Œ í•  ìˆ˜ ìˆë‹¤.
     - ëŸ°íƒ€ì„ì—ì„œì˜ ë°ì´í„° ìœ íš¨ì„± ê²€ì‚¬ë¥¼ í†µí•´ ê°œë°œìì™€ ì‚¬ìš©ìì—ê²Œ ìì„¸í•œ ëŸ°íƒ€ì„ ì—ëŸ¬ë¥¼ ë³´ì—¬ì£¼ê¸° ìœ„í•´ ê³ ì•ˆë˜ì—ˆë‹¤.
   - íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ë¡œëŠ” í•  ìˆ˜ ì—†ëŠ” ëŸ°íƒ€ì„ì—ì„œ ë°œìƒí•˜ëŠ” ì˜¤ë¥˜ ê²€ì‚¬ë¥¼ ë•ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ ë³´ì¸ë‹¤.
   - superstruct ë¥¼ ì‚¬ìš©í•˜ì—¬ ìë°”ìŠ¤í¬ë¦½íŠ¸ì˜ ë°ì´í„° ìœ íš¨ì„± ê²€ì‚¬ê°€ ì‹¤í–‰ë˜ëŠ” êµ¬ì¡°.

   ```tsx
   import {
     assert,
     is,
     validate,
     object,
     number,
     string,
     array,
   } from "superstruct";

   const Article = object({
     id: number(),
     title: string(),
     tags: array(string()),
     author: object({
       id: number(),
     }),
   });

   const data = {
     id: 34,
     title: "Hello World",
     tags: ["news", "features"],
     author: {
       id: 1,
     },
   };

   assert(data, Article);
   is(data, Article);
   validate(data, Article);
   ```

   - ìœ„ ì½”ë“œë¡œ Article ì€ id ëŠ” ìˆ«ì, title ì€ ë¬¸ìì—´, tags ëŠ” ë¬¸ìì—´ ë°°ì—´, author ì€ id ë¼ëŠ” ìˆ«ìë¥¼ ì†ì„±ìœ¼ë¡œ ê°€ì§„ ê°ì²´ì˜ object ê°€ ë˜ë©°, ìœ„ì™€ ê°™ì€ **ë°ì´í„° ëª…ì„¸ë¥¼ ê°€ì§„ ìŠ¤í‚¤ë§ˆ**ê°€ ëœë‹¤.
   - ìœ íš¨ì„± ê²€ì‚¬ë¥¼ í•˜ëŠ” 3ê°€ì§€ ëª¨ë“ˆ
   - ê·¸ë ‡ë‹¤ë©´ íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ì—ì„œëŠ”?? Infer ë¥¼ ì‚¬ìš©í•˜ì—¬ ê¸°ì¡´ íƒ€ì… ì„ ì–¸ ë°©ì‹ê³¼ ë™ì¼í•˜ê²Œ íƒ€ì…ì„ ì„ ì–¸í•  ìˆ˜ ìˆë‹¤.

   ```tsx
   import { Infer, number, object, string } from "superstruct";

   const User = object({
     id: number(),
     email: string(),
     name: string(),
   });

   type User = Infer<typeof User>;

   import { assert } from "superstruct";

   function isUser(user: User) {
     assert(user, User);
     console.log("ì ì ˆí•œ ìœ ì €ì…ë‹ˆë‹¤.");
   }

   const user_A = {
     id: 4,
     email: "test@example.com",
     name: "John Doe",
   };

   const user_B = {
   	id: 5,
   	email: "wrong@example.com"
   	name: 4,
   }

   isUser(user_A); // ì ì ˆí•œ ìœ ì €ì…ë‹ˆë‹¤.
   isUser(user_B);
   // Error TS2345: Argument of type
   //'{ id: number; email: string; name: number; }'
   //is not assignable to parameter of type
   //'{ id: number; email: string; name: string; }'.
   ```

   - ì´ë ‡ê²Œ ì»´íŒŒì¼ ë‹¨ê³„ê°€ ì•„ë‹Œ ëŸ°íƒ€ì„ì—ì„œë„ ì ì ˆí•œ ë°ì´í„°ì¸ì§€ í™•ì¸í•˜ëŠ” ê²€ì‚¬ê°€ í•„ìš”í•  ë•Œ ìœ ìš©í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

1. ì‹¤ì œ API ì‘ë‹µ ì‹œì˜ Superstruct í™œìš© ì‚¬ë¡€

   ```tsx
   interface ListItem {
     id: string;
     content: string;
   }

   interface ListResponse {
     items: ListItem[];
   }

   const fetchList = async (
     filter?: ListFetchFilter
   ): Promise<ListResponse> => {
     const { data } = await api
       .params({ ...filter })
       .get("/apis/get-list-summaries")
       .call<Response<ListResponse>>();

     return { data };
   };

   import { assert } from "superstruct";

   const ListItem = object({
     id: string(),
     content: string(),
   }); // ìŠ¤í‚¤ë§ˆ ë§Œë“¤ê¸°

   function isListItem(listItems: ListItem[]) {
     listItems.forEach((listItem) => assert(listItem, ListItem));
   } // ëŸ°íƒ€ì„ì—ì„œì˜ ìœ íš¨ì„± ê²€ì‚¬.
   ```

   - íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ë¡œ ì‘ì„±í•œ ì½”ë“œëŠ” ëª…ì‹œëœ íƒ€ì…ëŒ€ë¡œ ì‘ë‹µì´ ì˜¬ ê²ƒì´ë¼ê³  ê¸°ëŒ€í•œë‹¤. í•˜ì§€ë§Œ ì‹¤ì œ ì‘ë‹µ í˜•ì‹ì€ ë‹¤ë¥¼ ìˆ˜ ìˆë‹¤. íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ëŠ” ì»´íŒŒì¼íƒ€ì„ì— íƒ€ì…ì„ ê²€ì¦í•˜ëŠ” ì—­í• ì„ í•˜ë¯€ë¡œ ì‹¤ì œ ì„œë²„ ì‘ë‹µ í˜•ì‹ê³¼ ëª…ì‹œí•œ íƒ€ì…ì´ ì¼ì¹˜í•˜ëŠ”ì§€ëŠ” í™•ì¸í•  ìˆ˜ ì—†ë‹¤.
   - â­Â ê·¸ëŸ°ë° ì±…ì— ìˆëŠ” ì˜ˆì œì—ëŠ” ListItem ì˜ ìŠ¤í‚¤ë§ˆë¥¼ ë§Œë“œëŠ” ë¶€ë¶„ì´ ì—†ë‹¤. í•˜ì§€ë§Œ assertëŠ” ëŸ°íƒ€ì„ì—ì„œ íƒ€ì…ì„ ê²€ì‚¬í•˜ëŠ” ì—°ì‚°ìì´ë¯€ë¡œ ListItem ì˜ ìŠ¤í‚¤ë§ˆë¥¼ ë”°ë¡œ ë§Œë“¤ í•„ìš”ê°€ ìˆì–´ ë³´ì¸ë‹¤.

# 7.2 API ìƒíƒœ ê´€ë¦¬í•˜ê¸°

> ì‹¤ì œ API ë¥¼ ìš”ì²­í•˜ëŠ” ì½”ë“œëŠ” ì»´í¬ë„ŒíŠ¸ ë‚´ì—ì„œ ë¹„ë™ê¸° í•¨ìˆ˜ë¥¼ ì§ì ‘ í˜¸ì¶œí•˜ì§€ëŠ” ì•ŠëŠ”ë‹¤. ë¹„ë™ê¸° API ë¥¼ í˜¸ì¶œí•˜ê¸° ìœ„í•´ì„œëŠ” API ì˜ ì„±ê³µ, ì‹¤íŒ¨ì— ë”°ë¥¸ ìƒíƒœê°€ ê´€ë¦¬ ë˜ì–´ì•¼ í•˜ë¯€ë¡œ ìƒíƒœ ê´€ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ ì•¡ì…˜ì´ë‚˜ í›…ê³¼ ê°™ì´ ì¬ì •ì˜ ëœ í˜•íƒœë¥¼ ì‚¬ìš©í•´ì•¼ í•œë‹¤.

1. ìƒíƒœ ê´€ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ì„œ í˜¸ì¶œí•˜ê¸°

   > ìƒíƒœ ê´€ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ ë¹„ë™ê¸° í•¨ìˆ˜ë“¤ì€ ì„œë¹„ìŠ¤ ì½”ë“œë¥¼ ì‚¬ìš©í•´ì„œ ë¹„ë™ê¸° ìƒíƒœë¥¼ ë³€í™”ì‹œí‚¬ ìˆ˜ ìˆëŠ” í•¨ìˆ˜ë¥¼ ì œê³µí•œë‹¤. ì»´í¬ë„ŒíŠ¸ëŠ” ì´ëŸ¬í•œ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ì„œ í•¨ìˆ˜ì˜ ìƒíƒœë¥¼ êµ¬ë…í•˜ë©°, ìƒíƒœê°€ ë³€ê²½ë  ë•Œ ì»´í¬ë„ŒíŠ¸ë¥¼ ë‹¤ì‹œ ë Œë”ë§í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ë™ì‘í•œë‹¤.

   - Redux ë¥¼ ì‚¬ìš©í•œ ìƒíƒœê´€ë¦¬
   - API í˜¸ì¶œí•  ë•Œ, í˜¸ì¶œí•œ ë’¤ ê·¸ë¦¬ê³  í˜¸ì¶œí•˜ê³  ì—ëŸ¬ê°€ ë°œìƒí–ˆì„ ë•Œ ê°ê° setApiCall ì„ í˜¸ì¶œí•´ì„œ ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸í•´ì•¼ í•œë‹¤. Redux ëŠ” ë¹„ë™ê¸° ìƒíƒœê°€ ì•„ë‹Œ ì „ì—­ ìƒíƒœë¥¼ ìœ„í•´ ë§Œë“¤ì–´ì§„ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì´ê¸° ë•Œë¬¸ì— ë¯¸ë“¤ì›¨ì–´(thunk, saga ë“±) ì—¬ëŸ¬ ë„êµ¬ë¥¼ ë„ì…í•˜ì—¬ ë¹„ë™ê¸° ìƒíƒœë¥¼ ê´€ë¦¬í•œë‹¤. ë”°ë¼ì„œ ë³´ì¼ëŸ¬ í”Œë ˆì´íŠ¸ ì½”ë“œê°€ ë§ì•„ì§€ê³  ë¹„ë™ê¸° ìƒíƒœë¥¼ ê´€ë¦¬í•˜ê¸° ì–´ë ¤ìš´ ìƒí™©ì´ ë°œìƒí•œë‹¤.
   - MobX ì˜ˆì‹œ ì½”ë“œ
   - ëª¨ë“  ìƒíƒœ ê´€ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ì„œ ë¹„ë™ê¸° ì²˜ë¦¬ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ê¸° ìœ„í•´ ì•¡ì…˜ì´ ì¶”ê°€ë  ë•Œë§ˆë‹¤ ê´€ë ¨ëœ ìŠ¤í† ì–´ë‚˜ ìƒíƒœê°€ ê³„ì† ëŠ˜ì–´ë‚œë‹¤. ì´ë¡œ ì¸í•œ ê°€ì¥ í° ë¬¸ì œì ì€ ì „ì—­ ìƒíƒœ ê´€ë¦¬ìê°€ ëª¨ë“  ë¹„ë™ê¸° ìƒíƒœì— ì ‘ê·¼í•˜ê³  ë³€ê²½í•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì´ë‹¤. ë§Œì•½ 2ê°œ ì´ìƒì˜ ì»´í¬ë„ŒíŠ¸ê°€ êµ¬ë…í•˜ê³  ìˆëŠ” ë¹„ë™ê¸° ìƒíƒœê°€ ìˆë‹¤ë©´ ì“¸ë°ì—†ëŠ” ë¹„ë™ê¸° í†µì‹ ì´ ë°œìƒí•˜ê±°ë‚˜ ì˜ë„ì¹˜ ì•Šì€ ìƒíƒœ ë³€ê²½ì´ ë°œìƒí•  ìˆ˜ ìˆë‹¤.

1. í›…ìœ¼ë¡œ í˜¸ì¶œí•˜ê¸°

   - reat-query ë‚˜ useSwr ê°™ì€ í›…ì„ ì‚¬ìš©í•œ ë°©ë²•ì€ ìƒíƒœ ë³€ê²½ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•œ ë°©ì‹ë³´ë‹¤ í›¨ì”¬ ê°„ë‹¨í•˜ë‹¤. ì´ëŸ¬í•œ í›…ì€ ìºì‹œë¥¼ ì‚¬ìš©í•˜ì—¬ ë¹„ë™ê¸° í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë©°, ìƒíƒœ ê´€ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ì„œ ë°œìƒí–ˆë˜ ì˜ë„ì¹˜ ì•Šì€ ìƒíƒœ ë³€ê²½ì„ ë°©ì§€í•˜ëŠ” ë° ë„ì›€ì´ ëœë‹¤.
   - useQuery ì™€ useMutaition ì˜ˆì‹œ

   ```tsx
   // Job ëª©ë¡ì„ í™•ì¸í•˜ëŠ” í›…
   const useFetchJobList = () => {
     return useQuery("fetchJobList", async () => {
       const response = await JobService.fetchJobList();
       // View Modelì„ ì‚¬ìš©í•´ì„œ ê²°ê³¼ ê´€ë¦¬
       return new JobList(response);
     });
   };

   // Job 1ê°œë¥¼ ì—…ë°ì´íŠ¸í•˜ëŠ” í›…
   const useUpdateJob = (
     id: number,
     // Job IDì™€ update QIR Query Option
     {
       onSuccess,
       ...options
     }: UseMutationOptions<void, Error, JobUpdateFormValue>
   ): UseMutationResult<void, Error, JobUpdateFormValue> => {
     const queryClient = useQueryClient();

     return useMutation(
       ["updateJob", id],
       async (jobUpdateForm: JobUpdateFormValue) => {
         await JobService.updateJob(id, jobUpdateForm);
       },
       {
         onSuccess: (data, variables, context) => {
           // ì„±ê³µ ì‹œ 'fetchJobList'ë¥¼ ë¬´íš¨í™”í•˜ì—¬ ëª©ë¡ì„ ê°±ì‹ 
           queryClient.invalidateQueries("fetchJobList");

           onSuccess && onSuccess(data, variables, context);
         },
         ...options,
       }
     );
   };
   ```

   - ìœ„ì˜ ì½”ë“œë¥¼ ì´í›„ ì»´í¬ë„ŒíŠ¸ì—ì„œ ì¼ë°˜ì ì¸ í›…ì„ í˜¸ì¶œí•˜ë“¯ ì‚¬ìš©í•˜ë©´ ëœë‹¤. ì»´í¬ë„ŒíŠ¸ê°€ ë°˜ë“œì‹œ ìµœì‹  ìƒíƒœë¥¼ í‘œí˜„í•˜ë ¤ë©´ í´ë§ í˜¹ì€ ì›¹ ì†Œì¼“ ë°©ì‹ì„ ì‚¬ìš©í•´ì•¼ í•œë‹¤.
   - `í´ë§` ì´ë€? ì£¼ê¸°ì ìœ¼ë¡œ ì„œë²„ì— ìš”ì²­ì„ ë³´ë‚´ ë°ì´í„°ë¥¼ ì—…ë°ì´íŠ¸ í•˜ëŠ” ê²ƒ. ì¼ì •í•œ ê°„ê²©ìœ¼ë¡œ ì„œë²„ì— ìš”ì²­ì„ ë³´ë‚´ ìµœì‹  ìƒíƒœë¥¼ ìœ ì§€í•œë‹¤.

   ```tsx
   const JobList: React.FC = () => {
     // ë¹„ë™ê¸° ë°ì´í„°ë¥¼ í•„ìš”í•  ì»´í¬ë„ŒíŠ¸ì—ì„œ ìì²´ ìƒíƒœë¡œ ì €ì¥
     const {
       isLoading,
       isError,
       error,
       refetch,
       data: jobList,
     } = useFetchJobList();

     // ê°„ë‹¨í•œ Polling ë¡œì§, ì‹¤ì‹œê°„ìœ¼ë¡œ í™”ë©´ì´ ê°±ì‹ ë¼ì•¼ í•˜ëŠ” ìš”êµ¬ê°€ ì—†ì–´ì„œ
     // 30ì´ˆ ê°„ê²©ìœ¼ë¡œ ê°±ì‹ í•œë‹¤
     useInterval(() => refetch(), 30000);

     // Loadingì¸ ê²½ìš°ì—ë„ í™”ë©´ì— í‘œì‹œí•´ì¤€ë‹¤
     if (isLoading) return <LoadingSpinner />;

     // Errorì— ê´€í•œ ë‚´ìš©ì€ 11.3 API ì—ëŸ¬ í•¸ë“¤ë§ì—ì„œ ë” ìì„¸í•˜ê²Œ ë‹¤ë£¬ë‹¤
     if (isError) return <ErrorAlert error={error} />;

     return (
       <div>
         {jobList.map((job) => (
           <Job job={job} />
         ))}
       </div>
     );
   };
   ```

   - ì£¼ê¸°ì ìœ¼ë¡œ ìš”ì²­ì„ ë³´ë‚´ ìµœì‹  ìƒíƒœë¥¼ ìœ ì§€í•œë‹¤.

   ### [ìš°ì•„í•œì˜ í˜„í™© ì´ì•¼ê¸°]

   ìµœê·¼ Redux ë‚˜ MobX ì™€ ê°™ì€ ì „ì—­ ìƒíƒœ ê´€ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ react-query ë¡œ ë³€ê²½í•˜ë ¤ê³  í•˜ëŠ” ì‹œë„ê°€ ë§ë‹¤. ë¹„ë™ê¸°ë¡œ ìƒíƒœë¥¼ ë³€ê²½í•˜ëŠ” ì½”ë“œ ì¦ê°€ â†’ ìƒíƒœ ê´€ë¦¬ ìŠ¤í† ì–´ê°€ ë¹„ëŒ€í•´ì§€ë©°, ì•¡ì…˜ê³¼ ìƒíƒœê°€ ë³µì¡í•´ì§„ë‹¤.

   ë˜í•œ ì—ëŸ¬ ë°œìƒ, ë¡œë”© ë“± ê°™ì€ ìƒíƒœëŠ” ì „ì—­ìœ¼ë¡œ ê´€ë¦¬í•  í•„ìš”ê°€ ì—†ê³ , ë‹¤ë¥¸ ì»´í¬ë„ŒíŠ¸ê°€ ì—ëŸ¬ ìƒíƒœì¸ì§€, ì„±ê³µ ìƒíƒœì¸ì§€ êµ¬ë…í•˜ëŠ” ê²½ìš° ì»´í¬ë„ŒíŠ¸ê°„ì˜ ê²°í•©ë„ì™€ ë³µì¡ë„ê°€ ë†’ì•„ì ¸ ìœ ì§€ë³´ìˆ˜ê°€ ì–´ë ¤ì›Œì§ˆ ìˆ˜ ìˆë‹¤. ì´ë¥¼ react - query ë¥¼ ì‚¬ìš©í•´ì„œ ì²˜ë¦¬í•¨.

   ë¬¼ë¡ ! react-query ê°€ ê°€ì¥ ë›°ì–´ë‚˜ë‹¤ëŠ” ì˜ë¯¸ëŠ” ì•„ë‹ˆë‹¤. í”„ë¡œì íŠ¸ì˜ ë„ë©”ì¸ê³¼ ê¸°ì¡´ ì½”ë“œì™€ì˜ í˜¸í™˜ì„±ì— ë”°ë¼ ì–´ë–¤ ìƒíƒœ ê´€ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì„ íƒí•  ì§€ ê³ ë¯¼í•´ì•¼ í•œë‹¤. ì •ë‹µì€ ì—†ë‹¤!!!

# 7.3 ì—ëŸ¬ í•¸ë“¤ë§

> ë¹„ë™ê¸° API í˜¸ì¶œì„ í•˜ë‹¤ ë³´ë©´ ìƒíƒœ ì½”ë“œì— ë”°ë¼ 401(ì¸ì¦ë˜ì§€ ì•Šì€ ì‚¬ìš©ì), 404 (ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ë¦¬ì†ŒìŠ¤), 500 (ì„œë²„ ë‚´ë¶€ ì—ëŸ¬), CORS ë“± ë‹¤ì–‘í•œ ì—ëŸ¬ê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤. íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ì—ì„œëŠ” ì–´ë–»ê²Œ ì´ëŸ¬í•œ ì—ëŸ¬ë¥¼ ì²˜ë¦¬í•˜ê³  ëª…ì‹œí•  ìˆ˜ ìˆëŠ”ì§€ ì•Œì•„ë³´ì.

1. íƒ€ì… ê°€ë“œ í™œìš©í•˜ê¸°

   - axios ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ì„œëŠ” Axios ì—ëŸ¬ì— ëŒ€í•´ **isAxiosError** ë¼ëŠ” íƒ€ì… ê°€ë“œë¥¼ ì œê³µí•˜ê³  ìˆë‹¤. íƒ€ì… ê°€ë“œë¥¼ ì§ì ‘ ì‚¬ìš©í•  ìˆ˜ë„ ìˆì§€ë§Œ, ì„œë²„ ì—ëŸ¬ì„ì„ ëª…í™•í•˜ê²Œ í‘œì‹œí•˜ê³  ì„œë²„ì—ì„œ ë‚´ë ¤ì£¼ëŠ” ì—ëŸ¬ ì‘ë‹µ ê°ì²´ì— ëŒ€í•´ì„œë„ êµ¬ì²´ì ìœ¼ë¡œ ì •ì˜í•¨ìœ¼ë¡œì„œ ì–´ë–¤ ì†ì„±ì„ ê°€ì¡ŒëŠ”ì§€ë¥¼ íŒŒì•…í•  ìˆ˜ ìˆë‹¤.

   ```tsx
   interface ErrorResponse {
     status: string;
     serverDateTime: string;
     errorCode: string;
     errorMessage: string;
   }
   // ë°˜í™˜ê°’ íƒ€ì… ì •ì˜
   function isServerError(error: unknown): error is AxiosError<ErrorResponse> {
     return axios.isAxiosError(error);
   }
   // axios.isAxiosErrorë¡œ ì²´í¬
   const onClickDeleteHistoryButton = async (id: string) => {
     try {
       await axios.post("https://...", { id });

       alert("ì£¼ë¬¸ ë‚´ì—­ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.");
     } catch (error: unknown) {
       if (
         isServerError(error) &&
         error.response &&
         error.response.data.errorMessage
       ) {
         // ì„œë²„ ì—ëŸ¬ì¼ ë•Œë§Œ ì²˜ë¦¬ë¥¼ ëª…ì‹œì ìœ¼ë¡œ í•  ìˆ˜ ìˆë‹¤
         setErrorMessage(error.response.data.errorMessage);
         return;
       }

       setErrorMessage(
         "ì¼ì‹œì ì¸ ì—ëŸ¬ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”."
       );
     }
   };
   ```

   - âš ï¸ ì‚¬ìš©ì ì •ì˜ íƒ€ì… ê°€ë“œë¥¼ ì •ì˜í•  ë•ŒëŠ” ë°˜í™˜ íƒ€ì…ìœ¼ë¡œ parameterName is Type í˜•íƒœë¡œ íƒ€ì… ëª…ì œë¥¼ ì •ì˜ í•´ì£¼ëŠ” ê²ƒì´ ì¢‹ë‹¤. parameterName ì€ ì‹œê·¸ë‹ˆì²˜ì— í¬í•¨ëœ ë§¤ê°œë³€ìˆ˜

1. ì—ëŸ¬ ì„œë¸Œí´ë˜ì‹± í•˜ê¸°

   > ì‹¤ì œ ìš”ì²­ì„ ì²˜ë¦¬í•  ë•Œ ë‹¨ìˆœí•œ ì„œë²„ ì—ëŸ¬ë„ ë°œìƒí•˜ì§€ë§Œ, ì¸ì¦ ì •ë³´ ì—ëŸ¬, ë„¤íŠ¸ì›Œí¬ ì—ëŸ¬, íƒ€ì„ ì•„ì›ƒ ì—ëŸ¬ ê°€ì€ ë‹¤ì–‘í•œ ì—ëŸ¬ê°€ ë°œìƒí•˜ê¸°ë„ í•œë‹¤. ì´ë¥¼ ë” ëª…ì‹œì ìœ¼ë¡œ í‘œì‹œí•˜ê¸° ìœ„í•´ **ì„œë¸Œí´ë˜ì‹±**ì„ í™œìš©í•  ìˆ˜ ìˆë‹¤.

   - âš ï¸ ì„œë¸Œí´ë˜ì‹±ì€ ê¸°ì¡´ í´ë˜ìŠ¤ë¥¼ í™•ì¥í•˜ì—¬ í•˜ìœ„ í´ë˜ìŠ¤ë¥¼ ë§Œë“œëŠ” ê³¼ì •

   ```tsx
   const getOrderHistory = async (page: number): Promise<History> => {
     try {
       const { data } = await axios.get(`https://some.site?page=${page}`);
       const history = await JSON.parse(data);

       return history;
     } catch (error) {
       alert(error.message);
     }
   };
   ```

   - ì£¼ë¬¸ ë‚´ì—­ì„ ìš”ì²­í•  ë•Œ ì—ëŸ¬ê°€ ë°œìƒí•˜ë©´ ì‚¬ìš©ìì—ê²Œ ì—ëŸ¬ë¥¼ í‘œì‹œí•´ì¤€ë‹¤. ì„œë²„ì—ì„œ ì „ë‹¬ëœ ì—ëŸ¬ ë©”ì„¸ì§€ë¥¼ ë³´ê³  ì‚¬ìš©ìëŠ” ì–´ë–¤ ì—ëŸ¬ê°€ ë°œìƒí•œ ê²ƒì¸ì§€ íŒë‹¨í•  ìˆ˜ ìˆë”ë¼ë„, ê°œë°œì ì…ì¥ì—ì„œëŠ” ì‚¬ìš©ì ë¡œê·¸ì¸ ì •ë³´ê°€ ë§Œë£Œë˜ì—ˆëŠ”ì§€, íƒ€ì„ì•„ì›ƒì´ ë°œìƒí•œ ê±´ì§€, ë°ì´í„°ë¥¼ ì˜ëª» ì „ë‹¬í•œ ê²ƒì¸ì§€ êµ¬ë¶„í•  ìˆ˜ ì—†ë‹¤.
   - ì„œë¸Œí´ë˜ì‹±ì„ í™œìš©í•˜ì—¬ ì—ëŸ¬ê°€ ë°œìƒí–ˆì„ ë•Œ ì½”ë“œìƒì—ì„œ ì–´ë–¤ ì—ëŸ¬ì¸ì§€ ë°”ë¡œ í™•ì¸í•  ìˆ˜ ìˆìœ¼ë©° ë™ì‹œì— ì—ëŸ¬ ì¸ìŠ¤í„´ìŠ¤ì— ë”°ë¼ ì²˜ë¦¬ ë°©ì‹ì„ ë‹¤ë¥´ê²Œ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤.

   ```tsx
   // ì—¬ëŸ¬ ì—ëŸ¬ ê°ì²´ ì •ì˜
   // ì—ëŸ¬ ê°ì²´ë¥¼ ìƒì†ë°›ì€ ê°ì²´ë“¤ ìƒì„±
   class OrderHttpError extends Error {
     private readonly privateResponse: AxiosResponse<ErrorResponse> | undefined;

     constructor(message?: string, response?: AxiosResponse<ErrorResponse>) {
       super(message);
       this.name = "OrderHttpError";
       this.privateResponse = response;
     }

     get response(): AxiosResponse<ErrorResponse> | undefined {
       return this.privateResponse;
     }
   }

   class NetworkError extends Error {
     constructor(message = "") {
       super(message);
       this.name = "NetworkError";
     }
   }

   class UnauthorizedError extends Error {
     constructor(message: string, response?: AxiosResponse<ErrorResponse>) {
       super(message, response);
       this.name = "UnauthorizedError";
     }
   }
   ```

```tsx
// HTTP ì—ëŸ¬ í•¸ë“¤ëŸ¬
// ì—ëŸ¬ ì½”ë“œë‚˜ ë©”ì„¸ì§€ì— ë”°ë¼ ì—ëŸ¬ ê°ì²´ ìƒì„±í›„ ë°˜í™˜
const httpErrorHandler = (
  error: AxiosError<ErrorResponse> | Error
): Promise<Error> => {
  let promiseError: Promise<Error>;

  if (axios.isAxiosError(error)) {
    if (Object.is(error.code, "ECONNABORTED")) {
      promiseError = Promise.reject(new TimeoutError());
    } else if (Object.is(error.message, "Network Error")) {
      promiseError = Promise.reject(new NetworkError(""));
    } else {
      const { response } = error as AxiosError<ErrorResponse>;
      switch (response?.status) {
        case HttpStatusCode.UNAUTHORIZED:
          promiseError = Promise.reject(
            new UnauthorizedError(response?.data.message, response)
          );
          break;
        default:
          promiseError = Promise.reject(
            new OrderHttpError(response?.data.message, response)
          );
      }
    }
  } else {
    promiseError = Promise.reject(error);
  }

  return promiseError;
};
```

```tsx
// ì—ëŸ¬ ì²˜ë¦¬ í•¨ìˆ˜
// ì—ëŸ¬ ê°ì²´ì— ë”°ë¥¸ ì—ëŸ¬ ì²˜ë¦¬. (ë©”ì„¸ì§€ ì¶œë ¥ ë“±)
const onActionError = (
  error: unknown,
  params: Omit<AlertPopup, "type" | "message">
) => {
  if (error instanceof UnauthorizedError) {
    onUnauthorizedError(
      error.message,
      errorCallback?.onUnauthorizedErrorCallback
    );
  } else if (error instanceof NetworkError) {
    alert("ë„¤íŠ¸ì›Œí¬ ì—°ê²°ì´ ì›í™œí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.", {
      onClose: errorCallback?.onNetworkErrorCallback,
    });
  } else if (error instanceof OrderHttpError) {
    alert(error.message, params);
  } else if (error instanceof Error) {
    alert(error.message, params);
  } else {
    alert(defaultHttpErrorMessage, params);
  }
};
```

```tsx
// ì‹¤ì œ api í˜¸ì¶œ ì½”ë“œ

const getOrderHistory = async (page: number): Promise<History> => {
  try {
    const { data } = await fetchOrderHistory({ page });
    const history = await JSON.parse(data);

    return history;
  } catch (error) {
    onActionError(error);
  }
};
```

- â­ ìœ„ ì½”ë“œë¥¼ ë³´ëŠ”ë° ì–´ë µê²Œ ë§Œë“  ì—ëŸ¬ ê°ì²´ë“¤ê³¼ ì´ë¥¼ í™œìš©í•˜ëŠ” httpErrorHandler í•¨ìˆ˜ê°€ ì‚¬ìš©ëœ ë¶€ë¶„ì´ ë³´ì´ì§€ ì•ŠëŠ”ë‹¤. ê·¸ë˜ì„œ ì–¸ì œ ì‚¬ìš©í•˜ëŠ”ì§€ ê¶ê¸ˆí•˜ì—¬ ì°¾ì•„ë³¸ ê²°ê³¼ â†’ `httpErrorHandler`ëŠ” **Axios Interceptor**ì™€ í•¨ê»˜ ì‚¬ìš©ë˜ì–´, Axios ìš”ì²­ì—ì„œ ë°œìƒí•œ ì—ëŸ¬ë¥¼ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ í˜¸ì¶œë  ìˆ˜ ìˆë‹¤ê³  í•œë‹¤. ( ì±…ì—ë„ axios ë¥¼ ì‚¬ìš©í•˜ê³  ìˆë‹¤ë©´ ì¡°ê±´ì— ë”°ë¼ ì¸í„°ì…‰í„°ì—ì„œ ì í•©í•œ ì—ëŸ¬ ê°ì²´ë¥¼ ì „ë‹¬í•  ìˆ˜ ìˆë‹¤ê³  ë˜ì–´ ìˆë‹¤. )

```tsx
import axios from "axios";

axios.interceptors.response.use(
  (response) => response,
  (error) => {
    return httpErrorHandler(error); // ì—ëŸ¬ í•¸ë“¤ë§
  }
);
```

- ìœ„ì²˜ëŸ¼ intercepter ì— ì—°ê²°í•˜ë©´ ì—ëŸ¬ì˜ ë°˜í™˜ê°’ì´ ì—ëŸ¬ ê°ì²´ê°€ ë˜ì–´ ì‹¤ì œ api í˜¸ì¶œ ì½”ë“œì—ì„œ onActionError í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ì—¬ ì—ëŸ¬ë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆê²Œ ëœë‹¤.
- ìœ„ì²˜ëŸ¼ ì—ëŸ¬ë¥¼ ì„œë¸Œí´ë˜ì‹±í•´ì„œ í‘œí˜„í•˜ë©´ ëª…ì‹œì ìœ¼ë¡œ ì—ëŸ¬ë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆê²Œ ëœë‹¤. error instanceof Error ì™€ ê°™ì´ ì‘ì„±ëœ íƒ€ì… ì¹´ë“œë¬¸ì„ í†µí•´ ì½”ë“œìƒì—ì„œ ì—ëŸ¬ í•¸ë“¤ë§ì— ëŒ€í•œ ë¶€ë¶„ì„ í•œëˆˆì— ë³¼ ìˆ˜ ìˆê²Œ ëœë‹¤.

1. ì¸í„°ì…‰í„°ë¥¼ í™œìš©í•œ ì—ëŸ¬ ì²˜ë¦¬

   - axios ëŠ” ì¸í„°ì…‰í„° ê¸°ëŠ¥ì„ ì œê³µí•œë‹¤. ì´ë¥¼ í™œìš©í•˜ì—¬ HTTP ì—ëŸ¬ì— ì¼ê´€ëœ ë¡œì§ì„ ì ìš©í•  ìˆ˜ ìˆë‹¤.

   ```tsx
   const httpErrorHandler = (
     error: AxiosError<ErrorResponse> | Error
   ): Promise<Error> => {
     if (error.response && error.response.status === 401) {
       // 401 ì—ëŸ¬ì¸ ê²½ìš° ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™
       window.location.href = `${backOfficeAuthHost}/login?targetUrl=${window.location.href}`;
     }
     return Promise.reject(error);
   };

   orderApiRequester.interceptors.response.use(
     (response: AxiosResponse) => response,
     httpErrorHandler
   ); // ì¸í„°ì…‰í„°ë¥¼ í†µí•´ ë™ì¼í•œ ë¡œì§ ì ìš©.
   ```

1. ì—ëŸ¬ ë°”ìš´ë”ë¦¬ë¥¼ í™œìš©í•œ ì—ëŸ¬ ì²˜ë¦¬

   - **ì—ëŸ¬ ë°”ìš´ë”ë¦¬ë€?** ë¦¬ì•¡íŠ¸ ì»´í¬ë„ŒíŠ¸ íŠ¸ë¦¬ì—ì„œ ì—ëŸ¬ê°€ ë°œìƒí•  ë•Œ ê³µí†µìœ¼ë¡œ ì—ëŸ¬ë¥¼ ì²˜ë¦¬í•˜ëŠ” ë˜ìµíŠ¸ ì»´í¬ë„ŒíŠ¸ì´ë‹¤.

   ```tsx
   import React, { ErrorInfo } from "react";
   import ErrorPage from "pages/ErrorPage";

   interface ErrorBoundaryProps {}

   interface ErrorBoundaryState {
     hasError: boolean;
   }

   class ErrorBoundary extends React.Component<
     ErrorBoundaryProps,
     ErrorBoundaryState
   > {
     constructor(props: ErrorBoundaryProps) {
       super(props);
       this.state = { hasError: false };
     }

     static getDerivedStateFromError(): ErrorBoundaryState {
       return { hasError: true };
     }

     componentDidCatch(error: Error, errorInfo: ErrorInfo): void {
       this.setState({ hasError: true });
       console.error(error, errorInfo);
     }

     render(): React.ReactNode {
       const { children } = this.props;
       const { hasError } = this.state;
       return hasError ? <ErrorPage /> : children;
     }
   }

   const App = () => {
     return (
       <ErrorBoundary>
         <OrderHistoryPage />
       </ErrorBoundary>
     );
   };
   ```

   - ì—ëŸ¬ ë°”ìš´ë”ë¦¬ë¥¼ ì‚¬ìš©í•˜ë©´ ì»´í¬ë„ŒíŠ¸ íŠ¸ë¦¬ í•˜ìœ„ì— ìˆëŠ” ì»´í¬ë„ŒíŠ¸ì—ì„œ ë°œìƒí•œ ì—ëŸ¬ë¥¼ ìºì¹˜í•˜ê³  í•´ë‹¹ ì—ëŸ¬ë¥¼ ê°€ì¥ ê°€ê¹Œìš´ ë¶€ëª¨ ì—ëŸ¬ ë°”ìš´ë”ë¦¬ì—ì„œ ì²˜ë¦¬í•  ìˆ˜ ìˆê²Œ í•œë‹¤. ì—ëŸ¬ ë°”ìš´ë”ë¦¬ë¥¼ ì—ëŸ¬ê°€ ë°œìƒí•œ ì»´í¬ë„ŒíŠ¸ ëŒ€ì‹ ì— ì—ëŸ¬ ì²˜ë¦¬ë¥¼ í•˜ê±°ë‚˜ ì˜ˆìƒì¹˜ ëª»í•œ ì—ëŸ¬ë¥¼ ê³µí†µìœ¼ë¡œ ì²˜ë¦¬í•  ë•Œ ì‚¬ìš©í•  ìˆ˜ ìˆìŒ.
   - OrderHistoryPage ì—ì„œ ì—ëŸ¬ê°€ ë°œìƒí•  ì‹œ ì—ëŸ¬ ë°”ìš´ë”ë¦¬ì—ì„œ ì—ëŸ¬ í˜ì´ì§€ë¥¼ ë…¸ì¶œí•œë‹¤. ì´ì™¸ì—ë„ ë¡œê·¸ë¥¼ ë³´ë‚´ëŠ” ì½”ë“œë¥¼ ì¶”ê°€í•˜ì—¬ ì˜ˆìƒì¹˜ ëª»í•œ ì—ëŸ¬ì˜ ë°œìƒ ì—¬ë¶€ë¥¼ ì¶”ì í•  ìˆ˜ ìˆë„ë¡ ë§Œë“¤ ìˆ˜ ìˆë‹¤.
   - ğŸ–Šï¸ ì»´í¬ë„ŒíŠ¸ íŠ¸ë¦¬ì—ì„œ í•˜ìœ„ ì»´í¬ë„ŒíŠ¸ì—ì„œ ë°œìƒí•œ ì—ëŸ¬ë¥¼ ê³µí†µìœ¼ë¡œ ì²˜ë¦¬í•˜ëŠ” ì—­í• ì„ í•˜ëŠ” ê²ƒìœ¼ë¡œ ë³´ì„

1. ìƒíƒœ ê´€ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ì„œì˜ ì—ëŸ¬ ì²˜ë¦¬

   - redux ì—ì„œì˜ ì—ëŸ¬ ì²˜ë¦¬ ë°©ë²•: ì„±ê³µì‹œ reponse ì¸í„°ì…‰í„°ì˜ error ìƒí™©ì—ì„œ ì—ëŸ¬ ìƒíƒœë¥¼ ê´€ë¦¬í•˜ì§€ ì•Šê³  ì²˜ë¦¬í•  ìˆ˜ ìˆë‹¤ë©´ ë°”ë¡œ ì²˜ë¦¬ (ì˜ˆ: 401, 403 ) í•˜ê³  ê·¸ë ‡ì§€ ì•Šë‹¤ë©´ reject ë¡œ ë„˜ê²¨ì¤€ë‹¤. ì´í›„ ì•¡ì…˜ìœ¼ë¡œ ì—ëŸ¬ë¥¼ ìƒíƒœë¡œ ì²˜ë¦¬í•œë‹¤.
   - ê·¸ë¦¬ê³  MobX ì˜ˆì‹œ.

1. react-query ë¥¼ í™œìš©í•œ ì—ëŸ¬ ì²˜ë¦¬

   - react-query swr ê³¼ ê°™ì€ ë°ì´í„° í˜ì¹­ ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” ìš”ì²­ì— ëŒ€í•œ ìƒíƒœë¥¼ ë°˜í™˜í•´ì£¼ê¸° ë•Œë¬¸ì— ìš”ì²­ ìƒíƒœë¥¼ í™•ì¸í•˜ê¸° ì‰½ë‹¤.
   - useQuery ì˜ { error }
   - ì§„ì§œ react- query GOD ğŸ‘

1. ê·¸ ë°–ì˜ ì—ëŸ¬ ì²˜ë¦¬

   - api ì‘ë‹µì€ ì£¼ë¡œ ì„±ê³µ ì‹œ 2xx ì½”ë“œ ë¥¼ ë°˜í™˜í•œë‹¤. ì¼ë°˜ì ìœ¼ë¡œ api ìš”ì²­ ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ì„œë„ HTTP ìƒíƒœ ì½”ë“œì— ë”°ë¼ ì„±ê³µì¸ì§€ ì‹¤íŒ¨ì¸ì§€ íŒë‹¨í•œë‹¤. ê·¸ëŸ¬ë‚˜ ë¹„ì§€ë‹ˆìŠ¤ ë¡œì§ì—ì„œì˜ ìœ íš¨ì„± ê²€ì¦ì— ì˜í•´ ì¶”ê°€ëœ ì»¤ìŠ¤í…€ ì—ëŸ¬ëŠ” 200 ì‘ë‹µê³¼ í•¨ê»˜ ë°”ë””ì— ë³„ë„ì˜ ìƒíƒœ ì½”ë“œë¥¼ ì „ë‹¬í•˜ê¸°ë„ í•œë‹¤. â†’ ì´ëŸ° ìƒí™©ì— í•„ìš”í•œ ì»¤ìŠ¤í…€ ì—ëŸ¬ë¥¼ ì–´ë–»ê²Œ êµ¬í˜„í•˜ëŠ”ê°€.
   - 1ë²ˆ ë°©ë²•

   ```tsx
   httpStatus: 200
   {
     "status": "C20005", // ì„±ê³µì¸ ê²½ìš° "SUCCESS"ë¥¼ ì‘ë‹µ
     "message": "ì¥ë°”êµ¬ë‹ˆì— í’ˆì ˆëœ ë©”ë‰´ê°€ ìˆìŠµë‹ˆë‹¤."
   }

   const successHandler = (response: CreateOrderResponse) => {
     if (response.status === "SUCCESS") {
       // ì„±ê³µ ì‹œ ì‹¤í–‰í•  ë¡œì§ì„ ì¶”ê°€í•œë‹¤
       return;
     }
     throw new CustomError(response.status, response.message);
   };

   const createOrder = (data: CreateOrderData) => {
     try {
       const response = apiRequester.post("https://...", data);
       successHandler(response);
     } catch (error) {
       errorHandler(error);
     }
   };
   ```

   - ìœ„ì˜ ë°©ë²•ì„ ì‚¬ìš©í•˜ë©´ ê°„ë‹¨í•˜ê²Œ ì»¤ìŠ¤í…€ì—ëŸ¬ë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆì§€ë§Œ, ë§¤ë²ˆ if ë¬¸ì„ ì¶”ê°€í•˜ì—¬ì•¼ í•œë‹¤.
   - 2ë²ˆ ë°©ë²•: ì¸í„°ì…‰í„° ì‚¬ìš© â† ì¼ê´„ì ìœ¼ë¡œ ì—ëŸ¬ ì²˜ë¦¬ ê°€ëŠ¥.

   ```tsx
   export const apiRequester: AxiosInstance = axios.create({
     baseURL: orderApiBaseUrl,
     ...defaultConfig,
   });

   export const httpSuccessHandler = (response: AxiosResponse) => {
     if (response.data.status !== "SUCCESS") {
       throw new CustomError(response.data.message, response);
     }
     return response;
   };

   apiRequester.interceptors.response.use(httpSuccessHandler, httpErrorHandler);

   const createOrder = (data: CreateOrderData) => {
     try {
       const response = apiRequester.post("https://...", data);
       successHandler(response);
     } catch (error) {
       // statusê°€ SUCCESSê°€ ì•„ë‹Œ ê²½ìš° ì—ëŸ¬ë¡œ ì „ë‹¬ëœë‹¤
       errorHandler(error);
     }
   };
   ```

   - ì¸í„°ì…‰í„°ì—ì„œ ì»¤ìŠ¤í…€ ì—ëŸ¬ë¥¼ íŒë‹¨í•˜ê³  ì—ëŸ¬ë¥¼ ë˜ì§ìœ¼ë¡œì„œ ì™¸ë¶€ì—ì„œ 200ë²ˆ ëŒ€ë¡œ ì˜¨ ì‘ë‹µì´ë¼ê³  í•˜ë”ë¼ë„ ì—ëŸ¬ë¡œ ì¸ì‹í•˜ê²Œ ëœë‹¤.

ğŸ„

# 7.4 API ëª¨í‚¹

> í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œì„ í•˜ë‹¤ë³´ë©´ ì„œë²„ API ê°€ ì™„ì„±ë˜ê¸° ì „ì— ê°œë°œì„ ì§„í–‰í•´ì•¼ í•˜ëŠ” ì¼ì´ ì¢…ì¢… ìƒ
> ê¸´ë‹¤. ê¸°íšì´ ì™„ë£Œë˜ê³  ì„œë²„ API ê°€ ì™„ì„±ëœ ë‹¤ìŒì— í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œì„ í•œ í›„ QA ë¥¼ ì§„í–‰í•  ìˆ˜
> ìˆë‹¤ë©´ ì¢‹ê² ì§€ë§Œ , í˜„ì‹¤ì—ì„œëŠ” í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œì´ ì„œë²„ ê°œë°œë³´ë‹¤ ë¨¼ì € ì´ë£¨ì–´ì§€ê±°ë‚˜ ì„œë²„ì™€ í”„
> ë¡ íŠ¸ì—”ë“œ ê°œë°œì´ ë™ì‹œì— ì´ë£¨ì–´ì§€ëŠ” ê²½ìš°ê°€ ë” ë§ë‹¤.
> ê·¸ë ‡ë‹¤ë©´ ì´ëŸ¬í•œ ìƒí™©ì—ì„œ í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œì„ ì–´ë–»ê²Œ ì§„í–‰í•  ìˆ˜ ìˆì„ê¹Œ ? ë‹¨ìˆœí•˜ê²ŒëŠ” ê°œë°œ ì¤‘
> ì¸ ì½”ë“œì— TEMP_DELIVERY_STATUS_TEXT = ë°°ë‹¬ ì¤‘ì´ì—ìš” ." ì™€ ê°™ì´ ì„ì‹œ ë³€ìˆ˜ë¥¼ ë§Œë“¤ì–´
> ì„œ ìš°ì„  UI ë¥¼ êµ¬í˜„í•  ìˆ˜ ìˆì„ ê²ƒì´ë‹¤. ê·¸ëŸ°ë° ë¦¬ë·° ì‘ì„± , ì£¼ë¬¸í•˜ê¸°ì™€ ê°™ì€ POST ìš”ì²­ì„ ë³´ë‚´
> ì•¼ í•œë‹¤ë©´ ê·¸ë¦¬ê³  ìš”ì²­ ì‘ë‹µì— ë”°ë¼ ê°ê¸° ë‹¤ë¥¸ íŒì—…ì„ ë³´ì—¬ì£¼ì–´ì•¼ í•œë‹¤ë©´ ì–´ë–»ê²Œ í•´ì•¼ í• ê¹Œ ?
> ì„œë²„ê°€ ë³„ë„ì˜ ê°€ì§œ ì„œë²„ Mack screr ë¥¼ ì œê³µí•œë‹¤ê³  í•˜ë”ë¼ë„ í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œ ê³¼ì •ì—ì„œ ë°œìƒí• 
> ìˆ˜ ìˆëŠ” ëª¨ë“  ì˜ˆì™¸ ì‚¬í•­ì„ ì²˜ë¦¬í•˜ëŠ” ê²ƒì€ ì‰½ì§€ ì•Šë‹¤. ë˜í•œ ë§¤ë²ˆ í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´ êµ¬í˜„ì„ ë°˜ë³µí•´
> ì•¼ í•˜ê¸° ë•Œë¬¸ì— ë²ˆê±°ë¡œìš¸ ìˆ˜ ìˆë‹¤.

- ì´ëŸ´ ë•Œ `ëª¨í‚¹`ì´ë¼ëŠ” ë°©ë²•ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŒ. ëª¨í‚¹ì´ë€ ê°€ì§œ ëª¨ë“ˆì„ í™œìš©í•˜ëŠ” ê²ƒ.
- ìš°ì•„í•œí˜•ì œë“¤ í”„ë¡ íŠ¸ì—”ë“œì—ì„œëŠ” axios-mock-adapter, NextApi-Handler ë“±ì„ í™œìš©í•˜ì—¬ API ë¥¼ ëª¨í‚¹í•´ì„œ ì‚¬ìš©í•˜ê³  ìˆë‹¤.

1. JSON íŒŒì¼ ë¶ˆëŸ¬ì˜¤ê¸°

   - ê°„ë‹¨í•œ ì¡°íšŒë§Œ í•„ìš”í•œ ê²½ìš°ì—ëŠ” Json íŒŒì¼ì„ ë§Œë“¤ê±°ë‚˜ í˜¹ì€ ìë°”ìŠ¤í¬ë¦½íŠ¸ ì•ˆì— Json ì •ë³´ë¥¼ ì €ì¥í•˜ê³  export í•´ì„œ ì‚¬ìš©í•œë‹¤. ì´í›„ GET ìš”ì²­ì— íŒŒì¼ ê²½ë¡œë¥¼ ì‚½ì…í•´ì£¼ë©´ ì¡°íšŒ ì‘ë‹µìœ¼ë¡œ ì›í•˜ëŠ” ê°’ì„ ë°›ì„ ìˆ˜ ìˆë‹¤.

   ```tsx
   // mock/service.ts
   const SERVICES: Service[] = [
     {
       id: 0,
       name: "ë°°ë‹¬ì˜ë¯¼ì¡±",
     },
     {
       id: 1,
       name: "ë§Œí™”ê²½",
     },
   ];

   export default SERVICES;

   // api.ts
   import ApiRequester from "./ApiRequester";

   export const getServices = () => ApiRequester.get("/mock/service.ts");
   ```

   - ì‰½ê²Œ êµ¬í˜„í•  ìˆ˜ ìˆê³  ë¹ ë¥´ê²Œ êµ¬ì¶•í•  ë•Œ ìœ ìš©í•˜ë‹¤. ê·¸ëŸ¬ë‚˜ ì‹¤ì œ API URL ë¡œ ìš”ì²­í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆê¸°ì— ì¶”í›„ì— ìš”ì²­ ê²½ë¡œë¥¼ ë°”ê¾¸ì–´ì•¼ í•œë‹¤.

1. NextApiHandler í™œìš©í•˜ê¸°

   - Next.js í”„ë¡œì íŠ¸ë¥¼ ì‚¬ìš©í•˜ê³  ìˆë‹¤ë©´ NextApiHandler ë¥¼ í™œìš©í•  ìˆ˜ ìˆë‹¤.

   ```tsx
   // api í´ë” ë‚´ì— brands.ts ë¡œ ì„ ì–¸ë˜ì—ˆë‹¤ëŠ” ê°€ì •

   import { NextApiHandler } from "next";

   const BRANDS: Brand[] = [
     {
       id: 1,
       label: "ë°°ë¯¼ìŠ¤í† ì–´",
     },
     {
       id: 2,
       label: "ë¹„ë§ˆíŠ¸",
     },
   ];

   const handler: NextApiHandler = (req, res) => {
     // request ìœ íš¨ì„± ê²€ì¦

     // ì‘ë‹µ ë°ì´í„° ë°˜í™˜
     res.json(BRANDS);
   };

   export default handler;

   const fetchBrands = async () => {
     const response = await fetch("/api/brands"); // ì´ë ‡ê²Œ í˜¸ì¶œí•œë‹¤.
     const data = await response;
     console.log(data);
   };

   fetchBrands();
   ```

1. API ìš”ì²­ í•¸ë“¤ëŸ¬ì— ë¶„ê¸° ì¶”ê°€í•˜ê¸°

   - ìš”ì²­ ê²½ë¡œë¥¼ ìˆ˜ì •í•˜ì§€ ì•Šê³  í‰ì†Œì— ê°œë°œí•  ë•Œ í•„ìš”í•œ ê²½ìš°ì—ë§Œ ì‹¤ì œ ìš”ì²­ì„ ë³´ë‚´ê³  ê·¸ ì™¸ì—ëŠ” ëª©ì—…ì„ ì‚¬ìš©í•˜ì—¬ ê°œë°œí•˜ê³  ì‹¶ì„ ë•Œ í•˜ëŠ” ë°©ë²•

   ```tsx
   const useMock = true; // Mock ë°ì´í„°ë¥¼ ì‚¬ìš©í• ì§€ ì—¬ë¶€

   const mockFetchBrands = (): Promise<FetchBrandsResponse> =>
     new Promise((resolve) =>
       setTimeout(() => {
         resolve({
           status: "SUCCESS",
           message: null,
           data: [
             {
               id: 1,
               label: "ë°°ë¯¼ìŠ¤í† ì–´",
             },
             {
               id: 2,
               label: "ë¹„ë§ˆíŠ¸",
             },
           ],
         });
       }, 500)
     );

   const fetchBrands = () => {
     if (useMock) {
       return mockFetchBrands();
     }
     return requester.get("/brands");
   };
   ```

   - ì´ ë°©ë²•ì„ ì‚¬ìš©í•˜ë©´ ê°œë°œì´ ì™„ë£Œëœ ì´í›„ì—ë„ ìœ ì§€ë³´ìˆ˜í•  ë•Œ ëª©ì—… í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆì§€ë§Œ, ëª¨ë“  API ìš”ì²­ì— if ë¶„ê¸°ë¬¸ì„ ì¶”ê°€í•´ì•¼ í•˜ë¯€ë¡œ ë²ˆê±°ë¡­ê²Œ ëŠê»´ì§ˆ ìˆ˜ ìˆë‹¤.

1. axios-mock-adapter ë¡œ ëª¨í‚¹í•˜ê¸°.

   - í•¨ìˆ˜ì— ë¶„ê¸°ë¬¸ì´ ì¶”ê°€ë˜ëŠ” ê²ƒì„ ë°”ë¼ì§€ ì•ŠëŠ”ë‹¤ë©´ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
   - axios-mock-adapter ëŠ” Axios ìš”ì²­ì„ ê°€ë¡œì±„ì„œ ìš”ì²­ì— ëŒ€í•œ ì‘ë‹µ ê°’ì„ ëŒ€ì‹  ë°˜í™˜í•œë‹¤.

   ```tsx
   import axios from "axios";
   import MockAdapter from "axios-mock-adapter";
   import fetchOrderListSuccessResponse from "./fetchOrderListSuccessResponse.json";

   interface MockResult {
     status?: number;
     delay?: number;
     use?: boolean;
   }

   const mock = new MockAdapter(axios, { onNoMatch: "passthrough" });

   // ê¸°ë³¸ ì„±ê³µ Mock ì„¤ì •
   export const fetchOrderListMock = () =>
     mock.onGet(/order\/list/).reply(200, fetchOrderListSuccessResponse);

   // Lazy ë°ì´í„° ìƒì„± í•¨ìˆ˜
   export const lazyData = (
     status: number = Math.random() > 0.5 ? 200 : 400,
     successData: unknown = { message: "Success" },
     failData: unknown = { message: "Error" },
     time: number = Math.floor(Math.random() * 1000)
   ): Promise<[number, unknown]> =>
     new Promise((resolve) => {
       setTimeout(() => {
         resolve([status, status === 200 ? successData : failData]);
       }, time);
     });

   // Mock ë°ì´í„°ì™€ ì„¤ì •ì„ ì‚¬ìš©í•˜ëŠ” í•¨ìˆ˜
   export const fetchOrderListWithOptions = ({
     status = 200,
     time = 100,
     use = true,
   }: MockResult) => {
     if (use) {
       mock.onGet(/order\/list/).reply(() =>
         lazyData(status, fetchOrderListSuccessResponse, undefined, time)
       );
     }
   };

   export const fetchOrderListMock = () => mock.onPost(/Vorder/\list/).networkError();
   ```

   - axios-mock-adapter ë¥¼ ì‚¬ìš©í•˜ë©´ GET ë¿ë§Œ ì•„ë‹ˆë¼ POST, PUT, DELETE ë“± ë‹¤ë¥¸ HTTP ë©”ì„œë“œì— ëŒ€í•œ ëª©ì—…ì„ ì‘ì„±í•  ìˆ˜ ìˆê²Œ ëœë‹¤. ë˜í•œ networkError, timeoutError ë“±ì„ ë©”ì„œë“œë¡œ ì œê³µí•˜ê¸° ë•Œë¬¸ì— ì„ì˜ë¡œ ì—ëŸ¬ë„ ë°œìƒì‹œí‚¬ ìˆ˜ ìˆë‹¤.

1. ëª©ì—… ì‚¬ìš© ì—¬ë¶€ ì œì–´í•˜ê¸°

   - ë¡œì»¬ì—ì„œëŠ” ëª©ì—…ì„ ì‚¬ìš©í•˜ê³  devë‚˜ ìš´ì˜ í™˜ê²½ì—ì„œëŠ” ì‚¬ìš©í•˜ì§€ ì•Šìœ¼ë ¤ë©´ ê°„ë‹¨í•œ ì„¤ì •ì„ í†µí•´ í”Œë˜ê·¸ë¥¼ ì‚¬ìš©í•˜ì—¬ ëª©ì—…ìœ¼ë¡œ ê°œë°œí•  ë•Œì™€ ê°œë°œí•˜ì§€ ì•Šì„ ë•Œë¥¼ êµ¬ë¶„í•œë‹¤.

   ```tsx
   const mockFn = ({ status = 200, time = 100, use = true }: MockResult) => {
     if (use) {
       mock.onGet(/order\/list/).reply(
         () =>
           new Promise((resolve) => {
             setTimeout(() => {
               resolve([
                 status,
                 status === 200 ? fetchOrderListSuccessResponse : undefined,
               ]);
             }, time);
           })
       );
     }
   };

   // í™˜ê²½ ë³€ìˆ˜ë¡œ Mock í™œì„±í™” ì—¬ë¶€ë¥¼ íŒë‹¨
   const useMock = Object.is(process.env.REACT_APP_MOCK, "true");

   if (useMock) {
     mockFn({ status: 200, time: 10, use: true });
   }
   ```

   - ìœ„ì²˜ëŸ¼ í™˜ê²½ ë³€ìˆ˜ì— ë”°ë¼ mockFn ì„ ì œì–´í•œë‹¤.
   - ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ ì‹œ êµ¬ë¶„ì„ ìœ„í•´ ì•„ë˜ì²˜ëŸ¼ config.js ì„¤ì •í•˜ì—¬ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤

   ```tsx
   "scripts": {
     "start:mock": "REACT_APP_MOCK=true npm run start",
     "start": "REACT_APP_MOCK=false react-scripts start"
   }
   ```

   - axios-mock-adapter ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš°ì—ëŠ” API ìš”ì²­ì„ ì¤‘ê°„ì— ê°€ë¡œì±„ëŠ” ê²ƒì´ê¸° ë•Œë¬¸ì— API ìš”ì²­ì„ ì£¼ê³  ë°›ì§€ ì•ŠëŠ”ë‹¤. ë”°ë¼ì„œ ë¸Œë¼ìš°ì €ê°€ ì œê³µí•˜ëŠ” ê°œë°œì ë„êµ¬ì˜ ë„¤íŠ¸ì›Œí¬ íƒ­ì—ì„œëŠ” í™•ì¸ì´ ì–´ë µë‹¤!!
   - API ìš”ì²­ì˜ íë¦„ì„ íŒŒì•…í•˜ê³  ì‹¶ë‹¤ë©´ react-query-devtools í˜¹ì€ redux test tool ê³¼ ê°™ì€ ë³„ë„ì˜ ë„êµ¬ë¥¼ ì‚¬ìš©í•´ì•¼ í•œë‹¤.
   - ëª©ì—…ì„ ì‚¬ìš©í•  ë•Œ ë„¤íŠ¸ì›Œí¬ ìš”ì²­ì„ í™•ì¸í•˜ê³  ì‹¶ì„ ë•ŒëŠ” ë„¤íŠ¸ì›Œí¬ì— ë³´ë‚¸ ìš”ì²­ì„ ë³€ê²½í•´ì£¼ëŠ” Cypress ê°™ì€ ë„êµ¬ì˜ ì›¹í›…ì„ ì‚¬ìš©í•˜ë©´ ëœë‹¤.
   - â­Â Cypress ëŠ” í”„ë¡ íŠ¸ì—”ë“œ í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ ì˜¤í”ˆ ì†ŒìŠ¤ ìë°”ìŠ¤í¬ë¦½íŠ¸ ì—”ë“œ íˆ¬ ì—”ë“œ í…ŒìŠ¤íŠ¸ ë„êµ¬ì´ë‹¤.
